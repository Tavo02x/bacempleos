"use strict";(function(){angular.module("BacApp.controllers.VerFeriaVirtual",[]).controller("VerFeriaVirtualController",function(n,t,i,r){n.model={};n.model.IdArea=0;n.model.Area="";n.model.Borrado=0;n.model.FechaCreacion=Date.now;n.model.nombre="";n.Create=function(){window.location=r.baseUrl+"FeriaVirtual/MantenimientoFeriaVirtual"};var u=function(n,t,r){var u=Utils.getFilterParameters(n);i.doGet(t,u).then(r)},f=function(n,t,r){var u={Objeto:n,Lista:[],Token:"",Id:0};i.doPost(t,u).then(r)};n.LoadGrid=function(){var r=JSON.parse(sessionStorage.getItem("role")),t=r.where(function(n){return n.AccionId==39}),u=Utils.decodeJWT(),f=eval(u.PaisesFiltro),i={IdPais:{value:f,cond:OConfig.condLike,type:OTypes.string,comp:"||"}},e=Utils.GetWidthWindow();e<=764?Utils.getGrid(t.length==0?ApiService.FeriaGridTodas:ApiService.FeriaGrid,i,"divFeriaVirtual",t.length==0?["",""]:["",""],t.length==0?"MobileColumn":"MobileColumn1",n.Redirect,5,"totalGrid","IdFeriaEmpleo","IdFeriaEmpleo","desc"):Utils.getGrid(t.length==0?ApiService.FeriaGridTodas:ApiService.FeriaGrid,i,"divFeriaVirtual",t.length==0?["Título de la feria","País","Fecha de cierre","Postulante","Ver"]:["Título de la feria","País","Fecha de cierre","Ver"],t.length==0?"Descripcion,NombrePais,FechaFinal,Aplicantes":"Descripcion,NombrePais,FechaFinal",n.Redirect,5,"totalGrid","IdFeriaEmpleo","IdFeriaEmpleo","desc")};n.FilterGrid=function(){var i=n.model.pais,f=JSON.parse(sessionStorage.getItem("role")),t=f.where(function(n){return n.AccionId==39}),e=Utils.decodeJWT(),r={},u;(i==""||i==undefined)&&(i=eval(e.PaisesFiltro));r={Descripcion:{value:n.model.nombre,cond:OConfig.condLike,type:OTypes.string,comp:"&&"},IdPais:{value:n.model.pais,cond:OConfig.condLike,type:OTypes.string,comp:"||"}};u=Utils.GetWidthWindow();u<=764?Utils.getGrid(t.length==0?ApiService.FeriaGridTodas:ApiService.FeriaGrid,r,"divFeriaVirtual",t.length==0?["",""]:["",""],t.length==0?"MobileColumn":"MobileColumn1",n.Redirect,5,"totalGrid","IdFeriaEmpleo","IdFeriaEmpleo","desc"):Utils.getGrid(t.length==0?ApiService.FeriaGridTodas:ApiService.FeriaGrid,r,"divFeriaVirtual",t.length==0?["Título de la feria","País","Fecha de cierre","Postulante","Ver"]:["Título de la feria","País","Fecha de cierre","Ver"],t.length==0?"Descripcion,NombrePais,FechaFinal,Aplicantes":"Descripcion,NombrePais,FechaFinal",n.Redirect,5,"totalGrid","IdFeriaEmpleo","IdFeriaEmpleo","desc")};n.Redirect=function(t){n.$apply(function(){n.model.IdArea=t.IdArea;n.model.Area=t.Area;n.model.Borrado=t.Borrado;var i=JSON.parse(sessionStorage.getItem("role")),u=i.where(function(n){return n.AccionId==39});window.location=r.baseUrl+(u.length==0?"FeriaVirtual/DetalleFeriaVirtual?IdFeriaEmpleo="+t.IdFeriaEmpleo:"FeriaVirtual/DetalleFeriaVirtualPostulante?IdFeriaEmpleo="+t.IdFeriaEmpleo)})};n.Guardar=function(){f(n.model,ApiService.AreaLaboralSave,function(n){n.Resultado?Utils.MessageBox("Mantenimiento Areas Laborales","Areás Laborales",n.Mensaje,"~/Content/Images/IconoConfimacion1.png",function(){return!1}):Utils.MessageBox("Mantenimiento Areas Laborales","Areas Laborales",n.Mensaje,"~/Content/Images/IconoErrorGeneral.png",function(){return!1})})};n.Cancelar=function(){n.model.Descripcion=""};n.AreaLaboralGet=function(){u({},ApiService.AreaLaboralGet,function(t){n.Areas=t.Lista})};n.getPaises=function(){var t=Utils.decodeJWT(),i={id:{value:t.UserId}};u(i,ApiService.GetPais,function(t){n.Paises=t.Lista})};n.VerificarSession=function(){var t,i,r;Utils.getUrlParameter("token")!=""&&(sessionStorage.hasOwnProperty("token")&&sessionStorage.removeItem("token"),t=Utils.getUrlParameter("token"),sessionStorage.setItem("token",t));sessionStorage.hasOwnProperty("token")||(t=Utils.getUrlParameter("token"),sessionStorage.setItem("token",t),console.log(t));sessionStorage.hasOwnProperty("role")?n.LoadGrid():(i=Utils.decodeJWT(),r={userid:{value:i.UserId}},u(r,ApiService.GetMenu,function(t){sessionStorage.setItem("role",t.Objeto);n.LoadGrid()}))};n.SeguridadJS=function(){var n=JSON.parse(sessionStorage.getItem("role")),t;n!=null&&(t=n.where(function(n){return n.TipoAccionId==3&&n.ReferenciasAux=="VerFeriaVirtualController"}),$.each(t,function(n,t){var i=eval("$scope."+t.ReferenciaJS);i!=undefined&&i!=null&&i!=""&&eval("$scope."+t.ReferenciaJS+"= function () { }")}))}})})();