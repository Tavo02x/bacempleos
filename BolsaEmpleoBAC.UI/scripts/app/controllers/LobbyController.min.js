"use strict";(function(){angular.module("BacApp.controllers.Lobby",[]).controller("LobbyController",function(n,t,i,r){n.model={};n.model.pais="";var f=function(n,t,r){var u=Utils.getFilterParameters(n);i.doGet(t,u).then(r)},u=function(n,t,r){var u={Objeto:0,Lista:n,Token:"",Id:0};i.doPost(t,u).then(r)};n.reload=function(){n.LoadGrid();n.GetPuestos();n.GetAplicantes();n.GetUsuarios();n.AdministradoresRegional();n.AdministradoresPais()};n.getPaises=function(){var t=Utils.decodeJWT(),i={id:{value:t.UserId}};f(i,ApiService.GetPais,function(t){n.Paises=t.Lista})};n.GetPuestos=function(){var i,t,r;n.model.pais!=null&&(i=Utils.decodeJWT(),t=[],n.model.pais==""?t=eval(i.PaisesFiltro):t.push(n.model.pais),r=t,u(r,ApiService.LobbyGetPuestos,function(t){n.puestos=t.Objeto}))};n.GetAplicantes=function(){var i,t,r;n.model.pais!=null&&(i=Utils.decodeJWT(),t=[],n.model.pais==""?t=eval(i.PaisesFiltro):t.push(n.model.pais),r=t,u(r,ApiService.LobbyGetAplicantes,function(t){n.aplicantes=t.Objeto}))};n.GetUsuarios=function(){var i,t,r;n.model.pais!=null&&(i=Utils.decodeJWT(),t=[],n.model.pais==""?t=eval(i.PaisesFiltro):t.push(n.model.pais),r=t,u(r,ApiService.LobbyGetUsuarios,function(t){n.usuarios=t.Objeto}))};n.AdministradoresRegional=function(){var i,t,r;n.model.pais!=null&&(i=Utils.decodeJWT(),t=[],n.model.pais==""?t=eval(i.PaisesFiltro):t.push(n.model.pais),r=t,u(r,ApiService.LobbyAdministradoresRegional,function(t){n.administradoresR=t.Objeto}))};n.AdministradoresPais=function(){var i,t,r;n.model.pais!=null&&(i=Utils.decodeJWT(),t=[],n.model.pais==""?t=eval(i.PaisesFiltro):t.push(n.model.pais),r=t,u(r,ApiService.LobbyAdministradoresPais,function(t){n.administradoresP=t.Objeto}))};n.LoadGrid=function(){var r=Utils.decodeJWT(),t=[],i;n.model.pais!=""&&n.model.pais!=null&&n.model.pais!=0?t.push(n.model.pais):t=eval(r.PaisesFiltro);i={IdPais:{value:t,cond:OConfig.condEquals,type:OTypes.default,comp:"||"}};Utils.getGrid(ApiService.PuestoGrid,i,"table",["TÃ­tulo del puesto","Fecha de cierre","Ver"],"Puesto,FechaCierreOferta",n.verificacion,5,"totalGrid","IdPuesto","IdPuesto","desc")};n.verificacion=function(n){sessionStorage.setItem("volver",r.baseUrl+"Principal/Index");window.location=r.baseUrl+"Puesto/VerPuesto?IdPuesto="+n.IdPuesto};n.VerificarSession=function(){var t,i,r;Utils.getUrlParameter("token")!=""&&(sessionStorage.hasOwnProperty("token")&&sessionStorage.removeItem("token"),t=Utils.getUrlParameter("token"),sessionStorage.setItem("token",t));sessionStorage.hasOwnProperty("token")||(t=Utils.getUrlParameter("token"),sessionStorage.setItem("token",t),console.log(t));sessionStorage.hasOwnProperty("role")?n.SeguridadJS():(i=Utils.decodeJWT(),r={userid:{value:i.UserId}},f(r,ApiService.GetMenu,function(t){sessionStorage.setItem("role",t.Objeto);n.SeguridadJS()}))};n.SeguridadJS=function(){var n=JSON.parse(sessionStorage.getItem("role")),t;n!=null&&(t=n.where(function(n){return n.TipoAccionId==3&&n.ReferenciasAux=="LobbyController"}),$.each(t,function(n,t){var i=eval("$scope."+t.ReferenciaJS);i!=undefined&&i!=null&&i!=""&&eval("$scope."+t.ReferenciaJS+"= function () { }")}))}})})();