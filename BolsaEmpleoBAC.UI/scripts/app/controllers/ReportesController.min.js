"use strict";(function(){angular.module("BacApp.controllers.Reportes",[]).controller("ReportesController",function(n,t,i,r){n.model={};n.model.Administrador="";n.model.pais="";n.model.Periodo="";n.model.FechaInicio="";n.model.FechaFinal="";n.model.Genero="";n.model.PaisRecidencia="";n.model.Idiomas=[];n.model.porcentaje="";n.model.Estado=[];n.model.Discapacidades=[];n.model.Paises=[];n.Paises={};n.Estados={};n.Idiomas={};n.Discapacidades={};n.show1=!0;n.show2=!1;n.show3=!0;n.show4=!1;n.step1Class="tapSelect";n.step2Class="taps";n.step3Class="tapSelect2";n.step4Class="taps2";var u=function(n,t,r){var u=Utils.getFilterParameters(n);i.doGet(t,u).then(r)},f=function(n,t,r){var u={Objeto:n,Lista:[],Token:"",Id:0};i.doPost(t,u).then(r)};n.changestep1=function(){n.show1=!0;n.show2=!1;n.step1Class="tapSelect";n.step2Class="taps"};n.changestep2=function(){n.show1=!1;n.show2=!0;n.step1Class="taps";n.step2Class="tapSelect"};n.changestep3=function(){n.show3=!0;n.show4=!1;n.step3Class="tapSelect2";n.step4Class="taps2";$("#imgEstadistica").attr("src",r.baseUrl+"Content/Images/IconoReportesEstadisticaRojo.png");$("#imgAplicantes").attr("src",r.baseUrl+"Content/Images/IconoReportesAplicantes.png")};n.changestep4=function(){n.show3=!1;n.show4=!0;n.step3Class="taps2";n.step4Class="tapSelect2";$("#imgEstadistica").attr("src",r.baseUrl+"Content/Images/IconoReportesEstadistica.png");$("#imgAplicantes").attr("src",r.baseUrl+"Content/Images/IconoReportesAplicantesRojo.png")};n.LoadGrid=function(){var i=Utils.GetWidthWindow(),r=Utils.decodeJWT(),u=eval(r.PaisesFiltro),t={IdPaisAplicacion:{value:u,cond:OConfig.condLike,type:OTypes.string,comp:"||"}};i<=764?Utils.getGrid(ApiService.ReportesListaPostulanteReporte,t,"Lista",["","",""],"ColumnMobile1,ColumnMobile2",n.Redirect,5,"totalGrid","IdPostulante,email","IdPostulante","desc","IdPostulante"):Utils.getGrid(ApiService.ReportesListaPostulanteReporte,t,"Lista",["Nombre","País","Edad","Aplicaciones","Ver"],"NombreCompleto,Pais,Edad,Aplicaciones",n.Redirect,5,"totalGrid","IdPostulante,email","IdPostulante","desc","IdPostulante")};n.FilterGrid=function(){var r=Utils.GetWidthWindow(),u=Utils.decodeJWT(),f=eval(u.PaisesFiltro),t={},i;n.model.Idiomas=Utils.getValCheck("idioma");n.model.Estado=Utils.getValCheck("estado");n.model.Discapacidades=Utils.getValCheck("discapacidad");n.model.Paises=Utils.getValCheck("pais");n.model.Paises.length==0&&(n.model.Paises=f);n.model.Genero!=""&&n.model.Genero!=null&&(i=!0,n.model.Genero=="0"&&(i=!1),t.Genero={value:i,cond:OConfig.condEquals,type:OTypes.default,comp:"||"});n.model.porcentaje!=""&&n.model.porcentaje!=null&&n.model.porcentaje!=0&&(t.Porcentaje={value:n.model.porcentaje,cond:OConfig.condLike,type:OTypes.string,comp:"||"});n.model.PaisResidencia!=""&&n.model.PaisResidencia!=null&&n.model.PaisResidencia!=0&&(t.PaisResidencia={value:n.model.PaisRecidencia,cond:OConfig.condEquals,type:OTypes.default,comp:"||"});n.model.Paises.length>0&&(t.IdPaisAplicacion={value:n.model.Paises,cond:OConfig.condLike,type:OTypes.string,comp:"||"});n.model.Estado.length>0&&(t.IdEstadoPerfil={value:n.model.Estado,cond:OConfig.condLike,type:OTypes.string,comp:"||"});n.model.Discapacidades.length>0&&(t.IdDiscapacidad={value:n.model.Discapacidades,cond:OConfig.condLike,type:OTypes.string,comp:"||"});n.model.Idiomas.length>0&&(t.IdIdioma={value:n.model.Idiomas,cond:OConfig.condLike,type:OTypes.string,comp:"||"});r<=764?Utils.getGrid(ApiService.ReportesListaPostulanteReporte,t,"Lista",["","",""],"ColumnMobile1,ColumnMobile2",n.Redirect,5,"totalGrid","IdPostulante,email","IdPostulante","desc"):Utils.getGrid(ApiService.ReportesListaPostulanteReporte,t,"Lista",["Nombre","País","Edad","Aplicaciones","Ver"],"NombreCompleto,Pais,Edad,Aplicaciones",n.Redirect,5,"totalGrid","IdPostulante,email","IdPostulante","desc")};n.Redirect=function(n){window.location=r.baseUrl+"/Postulante/VerPerfil?IdPostulante="+n.email};n.getPaises=function(){var t=Utils.decodeJWT(),i={id:{value:t.UserId}};u(i,ApiService.GetPais,function(t){n.Paises=t.Lista})};n.getIdiomas=function(){u({},ApiService.getIdioma,function(t){n.Idiomas=t.Lista})};n.DiscapacidadGet=function(){u({},ApiService.DiscapacidadGet,function(t){n.Discapacidades=t.Lista})};n.getEstados=function(){u({},ApiService.GetEstadoPerfil,function(t){n.Estados=t.Lista})};n.getAdministradores=function(){var t={idPais:{value:n.model.pais==""||n.model.pais==null?0:n.model.pais}};u(t,ApiService.ReportesUsuariosPorPais,function(t){n.Administradores=t.Lista})};n.Cargar=function(){n.Grafico1Aplicantes();n.Grafico2Aplicantes();n.Grafico3Aplicantes();n.Grafico4Aplicantes();n.Grafico5Aplicantes();n.Grafico6Aplicantes()};n.DefinirFecha=function(){var t,u,r;switch(+n.model.Periodo){case 1:$("#divFechaInicial").addClass("hidden");$("#divFechaFinal").addClass("hidden");t=new Date;u=t.setDate(t.getDate()-30);n.model.FechaInicio=u;n.model.FechaFinal=t;break;case 2:$("#divFechaInicial").addClass("hidden");$("#divFechaFinal").addClass("hidden");var i=new Date,f=new Date(i.getFullYear(),i.getMonth()-1,1),e=new Date(i.getFullYear(),i.getMonth()-0,0);n.model.FechaInicio=f;n.model.FechaFinal=e;break;case 3:$("#divFechaInicial").removeClass("hidden");$("#divFechaFinal").removeClass("hidden");break;default:r=new Date;n.model.FechaInicio=r;n.model.FechaFinal=r}};n.AplicarFiltroAplicantes=function(){n.model.Idiomas=Utils.getValCheck("idioma");n.model.Estado=Utils.getValCheck("estado");n.model.Discapacidades=Utils.getValCheck("discapacidad");n.model.Paises=Utils.getValCheck("pais");n.FilterGrid();n.Cargar()};n.DehacerFiltroAplicante=function(){n.model.Periodo="";n.model.FechaInicio="";n.model.FechaFinal="";n.model.Genero="";n.model.PaisRecidencia="";n.getPaises();n.getIdiomas();n.DiscapacidadGet();n.getEstados();n.LoadGrid();n.Cargar()};n.Grafico1Aplicantes=function(){var t=n.model.FechaInicio==""?null:n.model.FechaInicio,i=n.model.FechaFinal==""?null:n.model.FechaFinal,r=n.model.Paises.length==0?null:n.model.Paises.join(),f=n.model.Estado.length==0?null:n.model.Estado.join(),e=n.model.Idiomas.length==0?null:n.model.Idiomas.join(),o=n.model.porcentaje==""?null:n.model.porcentaje,s=n.model.Discapacidades.length==0?null:n.model.Discapacidades.join(),h=n.model.Genero==""?null:+n.model.Genero==0?!1:!0,c=n.model.PaisRecidencia==""?null:n.model.PaisRecidencia,l={fechaInicio:{value:t},fechaFinal:{value:i},paises:{value:r},estados:{value:f},idiomas:{value:e},porcentajeIdioma:{value:o},discapacidades:{value:s},sexo:{value:h},paisRecidencia:{value:c}};u(l,ApiService.ReporteInteresadosPorPais,function(n){function r(){var n=new google.visualization.DataTable;n.addColumn("string","Pais");n.addColumn("number","Aplicantes");n.addRows(t);var r=document.getElementById("Grafico1Aplicante"),i=new google.visualization.ColumnChart(r);google.visualization.events.addListener(i,"ready",function(){$("#png_Grafico1Aplicante").attr("href",i.getImageURI());$("#png_Grafico1Aplicante").addClass("link float-right");var n=$("#png_Grafico1Aplicante").html();n==""&&$("#png_Grafico1Aplicante").html('<span class="mdi mdi-download mdi-24px"><\/span>Descargar')});i.draw(n,{title:"",legend:{position:"none"},displayExactValues:!0,vAxis:{title:"Aplicantes"}})}var t=[],i=0;$.each(n.Lista,function(n,r){i+=+r.Cantidad;t.push([r.Pais,+r.Cantidad])});$("#totalGrafico1Aplicante").html(i);google.charts.load("current",{packages:["corechart"]});google.charts.setOnLoadCallback(r)})};n.Grafico2Aplicantes=function(){var t=n.model.FechaInicio==""?null:n.model.FechaInicio,i=n.model.FechaFinal==""?null:n.model.FechaFinal,r=n.model.Paises.length==0?null:n.model.Paises.join(),f=n.model.Estado.length==0?null:n.model.Estado.join(),e=n.model.Idiomas.length==0?null:n.model.Idiomas.join(),o=n.model.porcentaje==""?null:n.model.porcentaje,s=n.model.Discapacidades.length==0?null:n.model.Discapacidades.join(),h=n.model.Genero==""?null:+n.model.Genero==0?!1:!0,c=n.model.PaisRecidencia==""?null:n.model.PaisRecidencia,l={fechaInicio:{value:t},fechaFinal:{value:i},paises:{value:r},estados:{value:f},idiomas:{value:e},porcentajeIdioma:{value:o},discapacidades:{value:s},sexo:{value:h},paisRecidencia:{value:c}};u(l,ApiService.ReporteAplicantesPorArea,function(n){function r(){var n=new google.visualization.DataTable;n.addColumn("string","Area");n.addColumn("number","Aplicantes");n.addRows(t);var r=document.getElementById("Grafico2Aplicante"),i=new google.visualization.PieChart(r);google.visualization.events.addListener(i,"ready",function(){$("#png_Grafico2Aplicante").attr("href",i.getImageURI());$("#png_Grafico2Aplicante").addClass("link float-right");var n=$("#png_Grafico2Aplicante").html();n==""&&$("#png_Grafico2Aplicante").html('<span class="mdi mdi-download mdi-24px"><\/span>Descargar')});i.draw(n,{title:"",pieHole:.35})}var t=[],i=0;$.each(n.Lista,function(n,r){i+=+r.Cantidad;t.push([r.Area,+r.Cantidad])});$("#totalGrafico2Aplicante").html(i);google.charts.load("current",{packages:["corechart"]});google.charts.setOnLoadCallback(r)})};n.Grafico3Aplicantes=function(){var t=n.model.FechaInicio==""?null:n.model.FechaInicio,i=n.model.FechaFinal==""?null:n.model.FechaFinal,r=n.model.Paises.length==0?null:n.model.Paises.join(),f=n.model.Estado.length==0?null:n.model.Estado.join(),e=n.model.Idiomas.length==0?null:n.model.Idiomas.join(),o=n.model.porcentaje==""?null:n.model.porcentaje,s=n.model.Discapacidades.length==0?null:n.model.Discapacidades.join(),h=n.model.Genero==""?null:+n.model.Genero==0?!1:!0,c=n.model.PaisRecidencia==""?null:n.model.PaisRecidencia,l={fechaInicio:{value:t},fechaFinal:{value:i},paises:{value:r},estados:{value:f},idiomas:{value:e},porcentajeIdioma:{value:o},discapacidades:{value:s},sexo:{value:h},paisRecidencia:{value:c}};u(l,ApiService.ReporteAplicantesPorEstado,function(n){function r(){var n=new google.visualization.DataTable;n.addColumn("string","Estado");n.addColumn("number","Aplicantes");n.addRows(t);var r=document.getElementById("Grafico3Aplicante"),i=new google.visualization.PieChart(r);google.visualization.events.addListener(i,"ready",function(){$("#png_Grafico3Aplicante").attr("href",i.getImageURI());$("#png_Grafico3Aplicante").addClass("link float-right");var n=$("#png_Grafico3Aplicante").html();n==""&&$("#png_Grafico3Aplicante").html('<span class="mdi mdi-download mdi-24px"><\/span>Descargar')});i.draw(n,{title:"",pieHole:.35})}var t=[],i=0;$.each(n.Lista,function(n,r){i+=+r.Cantidad;t.push([r.Estado,+r.Cantidad])});$("#totalGrafico3Aplicante").html(i);google.charts.load("current",{packages:["corechart"]});google.charts.setOnLoadCallback(r)})};n.Grafico4Aplicantes=function(){var t=n.model.FechaInicio==""?null:n.model.FechaInicio,i=n.model.FechaFinal==""?null:n.model.FechaFinal,r=n.model.Paises.length==0?null:n.model.Paises.join(),f=n.model.Estado.length==0?null:n.model.Estado.join(),e=n.model.Idiomas.length==0?null:n.model.Idiomas.join(),o=n.model.porcentaje==""?null:n.model.porcentaje,s=n.model.Discapacidades.length==0?null:n.model.Discapacidades.join(),h=n.model.Genero==""?null:+n.model.Genero==0?!1:!0,c=n.model.PaisRecidencia==""?null:n.model.PaisRecidencia,l={fechaInicio:{value:t},fechaFinal:{value:i},paises:{value:r},estados:{value:f},idiomas:{value:e},porcentajeIdioma:{value:o},discapacidades:{value:s},sexo:{value:h},paisRecidencia:{value:c}};u(l,ApiService.ReporteAplicantesPorGenero,function(n){function r(){var n=new google.visualization.DataTable;n.addColumn("string","Genero");n.addColumn("number","Aplicantes");n.addRows(t);var r=document.getElementById("Grafico4Aplicante"),i=new google.visualization.PieChart(r);google.visualization.events.addListener(i,"ready",function(){$("#png_Grafico4Aplicante").attr("href",i.getImageURI());$("#png_Grafico4Aplicante").addClass("link float-right");var n=$("#png_Grafico4Aplicante").html();n==""&&$("#png_Grafico4Aplicante").html('<span class="mdi mdi-download mdi-24px"><\/span>Descargar')});i.draw(n,{title:"",pieHole:.35})}var t=[],i=0;$.each(n.Lista,function(n,r){i+=+r.Cantidad;t.push([r.Genero,+r.Cantidad])});$("#totalGrafico4Aplicante").html(i);google.charts.load("current",{packages:["corechart"]});google.charts.setOnLoadCallback(r)})};n.Grafico5Aplicantes=function(){var t=n.model.FechaInicio==""?null:n.model.FechaInicio,i=n.model.FechaFinal==""?null:n.model.FechaFinal,r=n.model.Paises.length==0?null:n.model.Paises.join(),f=n.model.Estado.length==0?null:n.model.Estado.join(),e=n.model.Idiomas.length==0?null:n.model.Idiomas.join(),o=n.model.porcentaje==""?null:n.model.porcentaje,s=n.model.Discapacidades.length==0?null:n.model.Discapacidades.join(),h=n.model.Genero==""?null:+n.model.Genero==0?!1:!0,c=n.model.PaisRecidencia==""?null:n.model.PaisRecidencia,l={fechaInicio:{value:t},fechaFinal:{value:i},paises:{value:r},estados:{value:f},idiomas:{value:e},porcentajeIdioma:{value:o},discapacidades:{value:s},sexo:{value:h},paisRecidencia:{value:c}};u(l,ApiService.ReporteAplicantesPorDiscapacidad,function(n){function r(){var n=new google.visualization.DataTable;n.addColumn("string","Discapacidad");n.addColumn("number","Aplicantes");n.addRows(t);var r=document.getElementById("Grafico5Aplicante"),i=new google.visualization.PieChart(r);google.visualization.events.addListener(i,"ready",function(){$("#png_Grafico5Aplicante").attr("href",i.getImageURI());$("#png_Grafico5Aplicante").addClass("link float-right");var n=$("#png_Grafico5Aplicante").html();n==""&&$("#png_Grafico5Aplicante").html('<span class="mdi mdi-download mdi-24px"><\/span>Descargar')});i.draw(n,{title:"",pieHole:.35})}var t=[],i=0;$.each(n.Lista,function(n,r){i+=+r.Cantidad;t.push([r.Discapacidad,+r.Cantidad])});$("#totalGrafico5Aplicante").html(i);google.charts.load("current",{packages:["corechart"]});google.charts.setOnLoadCallback(r)})};n.Grafico6Aplicantes=function(){var t=n.model.FechaInicio==""?null:n.model.FechaInicio,i=n.model.FechaFinal==""?null:n.model.FechaFinal,r=n.model.Paises.length==0?null:n.model.Paises.join(),f=n.model.Estado.length==0?null:n.model.Estado.join(),e=n.model.Idiomas.length==0?null:n.model.Idiomas.join(),o=n.model.porcentaje==""?null:n.model.porcentaje,s=n.model.Discapacidades.length==0?null:n.model.Discapacidades.join(),h=n.model.Genero==""?null:+n.model.Genero==0?!1:!0,c=n.model.PaisRecidencia==""?null:n.model.PaisRecidencia,l={fechaInicio:{value:t},fechaFinal:{value:i},paises:{value:r},estados:{value:f},idiomas:{value:e},porcentajeIdioma:{value:o},discapacidades:{value:s},sexo:{value:h},paisRecidencia:{value:c}};u(l,ApiService.ReporteAplicantesPorIdioma,function(n){function r(){var n=new google.visualization.DataTable;n.addColumn("string","Idioma");n.addColumn("number","Aplicantes");n.addRows(t);var r=document.getElementById("Grafico6Aplicante"),i=new google.visualization.BarChart(r);google.visualization.events.addListener(i,"ready",function(){$("#png_Grafico6Aplicante").attr("href",i.getImageURI());$("#png_Grafico6Aplicante").addClass("link float-right");var n=$("#png_Grafico6Aplicante").html();n==""&&$("#png_Grafico6Aplicante").html('<span class="mdi mdi-download mdi-24px"><\/span>Descargar')});i.draw(n,{title:"",legend:{position:"none"},displayExactValues:!0,hAxis:{title:"Aplicantes"}})}var t=[],i=0;$.each(n.Lista,function(n,r){i+=+r.Cantidad;t.push([r.Idioma,+r.Cantidad])});$("#totalGrafico6Aplicante").html(i);google.charts.load("current",{packages:["corechart"]});google.charts.setOnLoadCallback(r)})};n.AplicarFiltrosPuesto=function(){$("#popupLoading").modal("show");setTimeout(function(){$("#popupLoading").modal("hide")},5e3);$("#GraficoPuestoContenedor").removeClass("hidden");n.Grafico1Puesto();n.Grafico2Puesto()};n.DeshacerFiltrosPuesto=function(){$("#GraficoPuestoContenedor").addClass("hidden")};n.Grafico1Puesto=function(){var t={idPais:{value:n.model.pais},idUsuario:{value:n.model.Administrador}};u(t,ApiService.ReporteAplicantesPorPuesto,function(n){function r(){var n=new google.visualization.DataTable;n.addColumn("string","Puestos");n.addColumn("number","Aplicantes");n.addRows(t);var r=document.getElementById("Grafico1Puesto"),i=new google.visualization.PieChart(r);google.visualization.events.addListener(i,"ready",function(){$("#png_Grafico1Puesto").attr("href",i.getImageURI());$("#png_Grafico1Puesto").addClass("link float-right");var n=$("#png_Grafico1Puesto").html();n==""&&$("#png_Grafico1Puesto").html('<span class="mdi mdi-download mdi-24px"><\/span>Descargar')});i.draw(n,{title:"",pieHole:.35})}var t=[],i=0;$.each(n.Lista,function(n,r){i+=+r.Cantidad;t.push([r.Titulo,+r.Cantidad])});$("#totalGrafico1Puesto").html(i);google.charts.load("current",{packages:["corechart"]});google.charts.setOnLoadCallback(r)})};n.Grafico2Puesto=function(){var t={idPais:{value:n.model.pais},idUsuario:{value:n.model.Administrador}};u(t,ApiService.ReportePuestosActivos,function(n){function r(){var n=new google.visualization.DataTable;n.addColumn("string","Estado");n.addColumn("number","Puestos");n.addRows(t);var r=document.getElementById("Grafico2Puesto"),i=new google.visualization.PieChart(r);google.visualization.events.addListener(i,"ready",function(){$("#png_Grafico2Puesto").attr("href",i.getImageURI());$("#png_Grafico2Puesto").addClass("link float-right");var n=$("#png_Grafico2Puesto").html();n==""&&$("#png_Grafico2Puesto").html('<span class="mdi mdi-download mdi-24px"><\/span>Descargar')});i.draw(n,{title:"",pieHole:.35})}var t=[],i=0;$.each(n.Lista,function(n,r){i+=+r.Cantidad;t.push([r.Estado,+r.Cantidad])});$("#totalGrafico2Puesto").html(i);google.charts.load("current",{packages:["corechart"]});google.charts.setOnLoadCallback(r)})};n.SeguridadJS=function(){var n=JSON.parse(sessionStorage.getItem("role")),t;n!=null&&(t=n.where(function(n){return n.TipoAccionId==3&&n.ReferenciasAux=="ReportesController"}),$.each(t,function(n,t){var i=eval("$scope."+t.ReferenciaJS);i!=undefined&&i!=null&&i!=""&&eval("$scope."+t.ReferenciaJS+"= function () { }")}))}})})();