"use strict";(function(){angular.module("BacApp.controllers.main",[]).controller("mainController",function(n,t,i,r){n.baseUrl=r.baseUrl;n.Logout=function(){Session.EndSession()};n.ValidateSession=function(){var n=sessionStorage.getItem("token");(n==null||n==""||n==undefined)&&(window.location=r.baseUrl+"Principal/Login")};n.AplicarSeguridadHTML=function(){Utils.SeguridadHTML()};n.VerificarSession=function(){var t,i,r;Utils.getUrlParameter("token")!=""&&(sessionStorage.hasOwnProperty("token")&&sessionStorage.removeItem("token"),t=Utils.getUrlParameter("token"),sessionStorage.setItem("token",t));sessionStorage.hasOwnProperty("token")||(t=Utils.getUrlParameter("token"),sessionStorage.setItem("token",t));sessionStorage.hasOwnProperty("role")?Utils.getUrlParameter("token")!=""?(console.log("Refrescado"),i=Utils.decodeJWT(),r={userid:{value:i.UserId}},sessionStorage.removeItem("role"),u(r,ApiService.GetMenu,function(t){sessionStorage.setItem("role",t.Objeto);$("#menu").empty();n.CrearMenu();n.SeguridadJS();n.AplicarSeguridadHTML()})):n.CrearMenu():(i=Utils.decodeJWT(),r={userid:{value:i.UserId}},u(r,ApiService.GetMenu,function(t){sessionStorage.setItem("role",t.Objeto);$("#menu").empty();n.CrearMenu();n.SeguridadJS();n.AplicarSeguridadHTML()}))};var u=function(n,t,r){var u=Utils.getFilterParameters(n);i.doGet(t,u).then(r)};n.CrearMenu=function(){console.log("mainController");$("#menu").empty();var n="",t=JSON.parse(sessionStorage.getItem("role")),i=t.where(function(n){return n.TipoAccionId==1}),u=t.where(function(n){return n.TipoAccionId==2}),f=t.where(function(n){return n.TipoAccionId==7});$.each(i,function(t,i){if(n="",n+='<a id="btn'+i.AccionId+'" '+(i.URL==null?" >":'href="'+r.baseUrl+i.URL+'">'),n+='   <div class="opcion">',n+='       <div class="contenedorOpcion">',n+='           <div class="Texto">'+i.Nombre+"<\/div>",n+='           <img src="'+r.baseUrl+"/Content/Images/"+i.Icono+'.png" class="Imagen" />',n+="       <\/div>",n+="   <\/div>",n+="<\/a>",n+='<div id="'+i.AccionId+'" class="collapse"><\/div>',$("#menu").append(n),i.URL==null){$("#btn"+i.AccionId).unbind();$("#btn"+i.AccionId).on("click",function(){$("#"+i.AccionId).hasClass("collapse")?($("#"+i.AccionId).removeClass("collapse"),$("#"+i.AccionId).addClass("Expand")):($("#"+i.AccionId).removeClass("Expand"),$("#"+i.AccionId).addClass("collapse"))})}});$.each(u,function(t,i){if(n="",n+='<a id="btn'+i.AccionId+'" '+(i.URL==null?">":'href="'+r.baseUrl+i.URL+'">'),n+='   <div class="opcion subOpcion">',n+='       <div class="contenedorOpcion">',n+='           <div class="Texto">'+i.Nombre+"<\/div>",n+='           <img src="'+r.baseUrl+"/Content/Images/"+i.Icono+'.png" class="Imagen" />',n+="       <\/div>",n+="   <\/div>",n+="<\/a>",n+='<div id="'+i.AccionId+'" class="collapse"><\/div>',$("#"+i.ParentId).append(n),i.URL==null){$("#btn"+i.AccionId).unbind();$("#btn"+i.AccionId).on("click",function(){$("#"+i.AccionId).hasClass("collapse")?($("#"+i.AccionId).removeClass("collapse"),$("#"+i.AccionId).addClass("Expand")):($("#"+i.AccionId).removeClass("Expand"),$("#"+i.AccionId).addClass("collapse"))})}});$.each(f,function(t,i){if(n="",n+='<a id="btn'+i.AccionId+'" '+(i.URL==null?" >":'href="'+r.baseUrl+i.URL+'">'),n+='   <div class="opcion subSubOpcion">',n+='       <div class="contenedorOpcion">',n+='           <div class="Texto">'+i.Nombre+"<\/div>",n+='           <img src="'+r.baseUrl+"/Content/Images/"+i.Icono+'.png" class="Imagen" />',n+="       <\/div>",n+="   <\/div>",n+="<\/a>",n+='<div id="'+i.AccionId+'" class="collapse"><\/div>',$("#"+i.ParentId).append(n),i.URL==null){$("#btn"+i.AccionId).unbind();$("#btn"+i.AccionId).on("click",function(){$("#"+i.AccionId).hasClass("collapse")?($("#"+i.AccionId).removeClass("collapse"),$("#"+i.AccionId).addClass("Expand")):($("#"+i.AccionId).removeClass("Expand"),$("#"+i.AccionId).addClass("collapse"))})}})};n.SeguridadJS=function(){var n=JSON.parse(sessionStorage.getItem("role")),t;n!=null&&(t=n.where(function(n){return n.TipoAccionId==3&&n.ReferenciasAux=="mainController"}),$.each(t,function(n,t){var i=eval("$scope."+t.ReferenciaJS);i!=undefined&&i!=null&&i!=""&&eval("$scope."+t.ReferenciaJS+"= function () { }")}))}})})();