"use strict";(function(){angular.module("BacApp.controllers.verAplicarPuestos",["ngSanitize"]).controller("verAplicarPuestosController",function(n,t,i,r){n.model={};n.model.IdPuesto=0;n.model.IdPostulante=0;n.model.Titulo="";n.model.Descripcion="";n.model.FechaCierre="";n.model.Idiomas="";n.model.Jornada=0;n.model.Pais="";n.model.IdArea="";n.model.Area="";n.model.NivelAcademico="";n.model.ExperienciaRequerida=[];n.model.IsAplicado=!1;n.baseUrl=r.baseUrl;n.top=0;n.PuestosRelacionados={};n.AplicarPuesto=function(){$("#popupLoading").modal("show");var e=Utils.decodeJWT(),o={IdPuesto:{value:n.model.IdPuesto},IdPostulante:{value:e.UserId}},t="",i="",f="";n.model.IsAplicado?(t="Has eliminado tu aplicación correctamente",i="Ya no apareceras en la lista de candidatos al puesto.",f="Content/Images/IconoDesaplicarPuesto.png"):(t="Has aplicado correctamente al empleo",i="Un encargado del departamente de selección revisará tu perfil para continuar con el debido proceso",f="Content/Images/IconoAplicarPuesto.png");u(o,ApiService.PuestoAplicar,function(n){n.Resultado?Utils.MessageBox(t,t,i,f,function(){window.location=r.baseUrl+"Puesto/Puestosdisponibles";this.modal("hide")}):Utils.MessageBox("Aplicar/Desaplicar a un puesto","Aplicar/Desaplicar a un puesto",n.Mensaje,"Content/Images/IconoErrorGeneral.png",function(){this.modal("hide");$("#popupLoading").modal("hide")})})};n.EditarPuesto=function(){window.location=r.baseUrl+"Puesto/MantenimientoPuestoEdit?IdPuesto="+n.model.IdPuesto};n.VerPostulantes=function(){window.location=r.baseUrl+"Puesto/PostulantesPuesto?IdPuesto="+n.model.IdPuesto+"&Puesto="+n.model.Titulo};var u=function(n,t,r){var u=Utils.getFilterParameters(n);i.doGet(t,u).then(r)},f=function(n,t,r){var u={Objeto:n,Lista:[],Token:"",Id:n.PuestoInfo.IdPuesto};i.doPost(t,u).then(r)};n.getPuesto=function(){var t=Utils.getUrlParameter("IdPuesto"),i=Utils.decodeJWT(),r={idPuesto:{value:t},IdPostulante:{value:i.UserId}};u(r,ApiService.PuestoVer,function(t){var i,r;t.Resultado?(i=t.Objeto,n.model.IdPuesto=i.IdPuesto,n.model.Titulo=i.Titulo,n.model.Descripcion=i.Descripcion,n.model.FechaCierre=i.FechaCierre,n.model.Idiomas=i.Idiomas,n.model.Jornada=i.Jornada[0],n.model.Pais=i.Pais,n.model.IdArea=i.IdArea,n.model.Area=i.Area,n.model.NivelAcademico=i.NivelAcademico,n.model.IsAplicado=i.IsAplicado,n.model.ExperienciaRequerida=i.Requisitos,n.DescripcionPais=n.model.Pais,i.Requisitos.length==0&&(r={IdRequisito:0,Descripcion:"N/A"},n.model.ExperienciaRequerida.push(r)),n.model.IsAplicado?$("#btnAplicar").text("DESAPLICAR PUESTO"):$("#btnAplicar").text("APLICAR PUESTO"),$("#btnPostulantes").text("Ver aplicantes ("+i.CantidadAplicantes+")"),n.GetPuestosRelacionados(n.model.IdArea)):Utils.MessageBox("Ver Puesto","Puesto",t.Mensaje,"Content/Images/IconoErrorGeneral.png",function(){this.modal("hide");$("#popupLoading").modal("hide")})})};n.GetPuestosRelacionados=function(t){n.top=n.top+3;var i={IdArea:{value:t},Top:{value:n.top}};u(i,ApiService.PuestosGetRelacionados,function(t){n.PuestosRelacionados=t.Lista})};n.Volver=function(){window.location=sessionStorage.getItem("volver")};n.RealizarEntrevista=function(){var t=Utils.getUrlParameter("IdFeriaEmpleo");window.location=r.baseUrl+"Entrevistas/SolicitarEntrevistasFeria?IdFeriaEmpleo="+t+"&IdPuesto="+n.model.IdPuesto};n.AplicarSeguridadHTML=function(){Utils.SeguridadHTML()};n.SeguridadJS=function(){var n=JSON.parse(sessionStorage.getItem("role")),t;n!=null&&(t=n.where(function(n){return n.TipoAccionId==3&&n.ReferenciasAux=="verAplicarPuestosController"}),$.each(t,function(n,t){var i=eval("$scope."+t.ReferenciaJS);i!=undefined&&i!=null&&i!=""&&eval("$scope."+t.ReferenciaJS+"= function () { }")}))}})})();