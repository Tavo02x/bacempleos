"use strict";(function(){angular.module("BacApp.controllers.CompartirPerfil",["jkAngularRatingStars"]).controller("CompartirPerfilController",function(n,t,i,r){n.IdEntrevista=Utils.getUrlParameter("IdEntrevista");n.IdUsuario=Utils.decodeJWT().UserId;n.obj={};n.obj.IdPostulante="";n.obj.NombreCompleto="";n.obj.Nacionalidad="";n.obj.Identificacion="";n.obj.FechaNacimiento="";n.obj.Edad="";n.obj.Genero="";n.obj.EstadoCivil="";n.obj.Telefono="";n.obj.ImagenURL="";n.obj.PaisRecidencia="";n.obj.Vehiculo="";n.obj.Email="";n.obj.Zona1="";n.obj.Zona2="";n.obj.Zona3="";n.obj.EstudiaActualidad="";n.obj.DescripcionVentajaCompetitiva="";n.obj.GradoAcademico="";n.obj.Profesion="";n.obj.PretensionSalarial="";n.obj.TrabajoBAC="";n.obj.CurriculumURL="";n.obj.Favorito=!1;n.obj.IdTipoLicencia="";n.obj.EstadoPerfil="";n.obj.TitulosCertificaciones={};n.obj.ExperienciaLaboral={};n.obj.Habilidades={};n.obj.Referencias={};n.obj.Idiomas={};n.obj.Areas={};n.obj.Paises={};n.obj.Discapacidades={};n.obj.Calificacion={};n.Zona1={};n.Zona2={};n.Zona3={};n.Idiomas={};n.Paises={};n.Pretensiones={};n.Areas={};n.Discapacidades={};n.Entrevistas={};n.Comentarios={};n.Comentario={};n.Comentario.IdComentarios=0;n.Comentario.IdUSuario="";n.Comentario.IdPostulante="";n.Comentario.Descripcion="";n.Comentario.Borrado=!1;n.StepOne=!0;n.StepTwo=!1;n.StepThree=!1;n.Fecha="";n.Nombre="";n.Creador="";n.Puesto="";n.Estado="";n.TipoEntrevista=0;n.Url="";n.CalificacionGeneral=0;n.Preguntas={};n.ShowEnVivo=!1;n.ShowPregrabada=!1;n.Rate=3;n.IsAdmin=!0;n.readOnly=!0;n.onItemRating=function(n){alert("On Rating: "+n)};n.ChangeStepOne=function(){n.StepOne=!0;n.StepTwo=!1;n.StepThree=!1;$("#StepOne").removeClass("taps").addClass("tapSelect");$("#StepTwo").removeClass("tapSelect").addClass("taps");$("#StepThree").removeClass("tapSelect").addClass("taps")};n.ChangeStepTwo=function(){n.StepOne=!1;n.StepTwo=!0;n.StepThree=!1;$("#StepOne").removeClass("tapSelect").addClass("taps");$("#StepTwo").removeClass("taps").addClass("tapSelect");$("#StepThree").removeClass("tapSelect").addClass("taps")};n.ChangeStepThree=function(){n.StepOne=!1;n.StepTwo=!1;n.StepThree=!0;$("#StepOne").removeClass("tapSelect").addClass("taps");$("#StepTwo").removeClass("tapSelect").addClass("taps");$("#StepThree").removeClass("taps").addClass("tapSelect")};n.MarcarFavorito=function(){var t={id:{value:n.obj.IdPostulante}};u(t,ApiService.PostulanteMarcarfavorito,function(){var t;n.obj.Favorito?(n.obj.Favorito=!1,t=r.baseUrl+"Content/Images/IconoNoFavorito.png",$("#imgFavorito").attr("src",t),$("#txtMarcarFavorito").html(),$("#txtMarcarFavorito").html("Marcar favorito")):(n.obj.Favorito=!0,t=r.baseUrl+"Content/Images/IconoFavorito.png",$("#imgFavorito").attr("src",t),$("#txtMarcarFavorito").html(),$("#txtMarcarFavorito").html("Desmarcar favorito"))})};n.getInfo=function(){n.ChangeStepTwo();var t=Utils.getUrlParameter("IdPostulante"),o=sessionStorage.getItem("token"),i=Utils.decodeJWT(),e={username:{value:t==""?i.unique_name:t}};u(e,ApiService.PostulanteGet,function(t){var i;n.obj.IdPostulante=t.Objeto.IdPostulante;n.obj.NombreCompleto=t.Objeto.NombreCompleto;n.obj.Nacionalidad=t.Objeto.Nacionalidad;n.obj.Identificacion=t.Objeto.Identificacion;n.obj.FechaNacimiento=t.Objeto.FechaNacimiento;n.obj.Edad=f(t.Objeto.FechaNacimiento);n.obj.Genero=t.Objeto.Genero;n.obj.EstadoCivil=t.Objeto.EstadoCivil;n.obj.Telefono=t.Objeto.Telefono;n.obj.ImagenURL=t.Objeto.ImagenURL;n.obj.PaisRecidencia=t.Objeto.PaisRecidencia;n.obj.Vehiculo=t.Objeto.Vehiculo;n.obj.Email=t.Objeto.Email;n.obj.Zona1=t.Objeto.Zona1;n.obj.Zona2=t.Objeto.Zona2;n.obj.Zona3=t.Objeto.Zona3;n.obj.EstudiaActualidad=t.Objeto.EstudiaActualidad;n.obj.GradoAcademico=t.Objeto.GradoAcademico;n.obj.Profesion=t.Objeto.Profesion;n.obj.PretensionSalarial=t.Objeto.PretensionSalarial;n.obj.TrabajoBAC=t.Objeto.TrabajoBAC;n.obj.CurriculumURL=t.Objeto.CurriculumURL;n.obj.TitulosCertificaciones=t.Objeto.TitulosCertificaciones;n.obj.ExperienciaLaboral=t.Objeto.ExperienciaLaboral;n.obj.Habilidades=t.Objeto.Habilidades;n.obj.Referencias=t.Objeto.Referencias;n.obj.Idiomas=t.Objeto.Idiomas;n.obj.Areas=t.Objeto.Areas;n.obj.Paises=t.Objeto.Paises;n.obj.Discapacidades=t.Objeto.Discapacidades;n.obj.Favorito=t.Objeto.Favorito;n.obj.DescripcionVentajaCompetitiva=t.Objeto.DescripcionVentajaCompetitiva;n.obj.IdTipoLicencia=t.Objeto.IdTipoLicencia;n.obj.EstadoPerfil=t.Objeto.EstadoPostulante;n.Comentarios=t.Objeto.Comentarios;n.obj.Favorito?(i=r.baseUrl+"Content/Images/IconoFavorito.png",$("#imgFavorito").attr("src",i),$("#txtMarcarFavorito").html("Desmarcar favorito")):(i=r.baseUrl+"Content/Images/IconoNoFavorito.png",$("#imgFavorito").attr("src",i),$("#txtMarcarFavorito").html("Marcar favorito"));$("#FotoPerfil").attr("src",n.obj.ImagenURL);n.LoadEntrevistasAplicadas()})};var f=function(n){var t=new Date,i=new Date(n),r=t.getFullYear()-i.getFullYear(),u=t.getMonth()-i.getMonth();return(u<0||u===0&&t.getDate()<i.getDate())&&r--,r},u=function(n,t,r){var u=Utils.getFilterParameters(n);i.doGet(t,u).then(r)},e=function(n,t,r){var u={Objeto:n,Lista:[],Token:"",Id:0};i.doPost(t,u).then(r)};n.LoadEntrevistasAplicadas=function(){var t={IdEntrevista:{value:n.IdEntrevista}};u(t,ApiService.GetEntrevistaById,function(t){var i=t;i.IdTipoEntrevista==1?(n.Fecha=i.FechaEntrevista,n.Creador=i.Creada,n.Puesto=i.Puesto,n.Estado=i.Estado,n.TipoEntrevista=i.TipoEntrevista,n.Url=i.Url,n.CalificacionGeneral=i.CalificacionGeneral,n.IdTipoEntrevista==i.IdTipoEntrevista,n.ShowEnVivo=!0,n.ShowPregrabada=!1):(n.Fecha=i.Fecha,n.Nombre=i.Nombre,n.Creador=i.Creador,n.Puesto=i.Puesto,n.Preguntas=i.Preguntas,n.IdTipoEntrevista==i.IdTipoEntrevista,n.ShowEnVivo=!1,n.ShowPregrabada=!0)})};n.LimpiarComentarios=function(){n.Comentario.IdComentarios=0;n.Comentario.IdUsuario="";n.Comentario.IdPostulante="";n.Comentario.Descripcion="";n.Comentario.Borrado=!1};n.ReturnComment=function(){n.$apply(function(){n.LimpiarComentarios();n.getInfo()})};n.Guardar=function(){var t=Utils.decodeJWT();n.Comentario.IdUsuario=t.UserId;n.Comentario.IdPostulacion=n.obj.IdPostulante;e(n.Comentario,ApiService.ComentarioSave,function(n){n.Resultado?Utils.MessageBox("Comentarios","Comentarios",n.Mensaje,"Content/Images/IconoConfimacion1.png",function(){location.reload();this.modal("hide")}):Utils.MessageBox("Comentarios","Comentarios",n.Mensaje,"Content/Images/IconoErrorGeneral.png",function(){this.modal("hide");$("#popupLoading").modal("hide")})})};n.SeguridadJS=function(){var n=JSON.parse(sessionStorage.getItem("role")),t;n!=null&&(t=n.where(function(n){return n.TipoAccionId==3&&n.ReferenciasAux=="CompartirPerfilController"}),$.each(t,function(n,t){var i=eval("$scope."+t.ReferenciaJS);i!=undefined&&i!=null&&i!=""&&eval("$scope."+t.ReferenciaJS+"= function () { }")}))}})})();