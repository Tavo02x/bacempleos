"use strict";(function(){angular.module("BacApp.controllers.VerUsuarios",[]).controller("VerUsuariosController",function(n,t,i,r){n.model={};n.model.IdDescapacidad=0;n.model.NombreCompleto="";n.model.Borrado=0;n.model.FechaCreacion=Date.now;n.model.pais="";n.Paises={};var u=function(n,t,r){var u=Utils.getFilterParameters(n);i.doGet(t,u).then(r)},f=function(n,t,r){var u={Objeto:n,Lista:[],Token:"",Id:0};i.doPost(t,u).then(r)};n.getPaises=function(){var t=Utils.decodeJWT(),i={id:{value:t.UserId}};u(i,ApiService.GetPais,function(t){n.Paises=t.Lista})};n.LoadGrid=function(){var t=[],e=Utils.GetWidthWindow(),r,i;n.model.pais!=""&&n.model.pais!=null&&n.model.pais!=0?t.push(n.model.pais):(r=Utils.decodeJWT(),t=eval(r.PaisesFiltro));var u=[],o=JSON.parse(sessionStorage.getItem("role")),f=o.where(function(n){return n.TipoAccionId==6});f.length>0&&(u=f[0].ReferenciasAux.split(","));i={IdRol:{value:u,cond:OConfig.condLike,type:OTypes.string,comp:"||"},IdPais:{value:t,cond:OConfig.condLike,type:OTypes.string,comp:"||"}};e<=764?Utils.getGrid(ApiService.UsuarioGrid,i,"table",["",""],"ColumnMobile",n.Cargar,5,"totalGrid","IdUsuario,Borrado,IdPais","IdUsuario","desc"):Utils.getGrid(ApiService.UsuarioGrid,i,"table",["Nombre","Email","Rol","País","Ver"],"NombreCompleto,Usuario,NombreRol,NombrePais",n.Cargar,5,"totalGrid","IdUsuario,Borrado,IdPais","IdUsuario","desc")};n.Filter=function(){var t=[],u=Utils.GetWidthWindow(),r,i;n.model.pais!=""&&n.model.pais!=null&&n.model.pais!=0?t.push(n.model.pais):(r=Utils.decodeJWT(),t=eval(r.PaisesFiltro));i={NombreCompleto:{value:n.model.NombreCompleto,cond:OConfig.condLike,type:OTypes.string,comp:"||"},IdPais:{value:t.join(),cond:OConfig.condLike,type:OTypes.string,comp:"||"}};u<=764?Utils.getGrid(ApiService.UsuarioGrid,i,"table",["",""],"ColumnMobile",n.Cargar,5,"totalGrid","IdUsuario,Borrado,IdPais","IdUsuario","desc"):Utils.getGrid(ApiService.UsuarioGrid,i,"table",["Nombre","Email","Rol","País","Ver"],"NombreCompleto,Usuario,NombreRol,NombrePais",n.Cargar,5,"totalGrid","IdUsuario,Borrado,IdPais","IdUsuario","desc")};n.New=function(){window.location=r.baseUrl+"Usuario/Usuarios?IdUsuario=0"};n.Cargar=function(n){window.location=r.baseUrl+"Usuario/Usuarios?IdUsuario="+n.IdUsuario};n.Guardar=function(){f(n.model,ApiService.DiscapacidadSave,function(n){n.Resultado?Utils.MessageBox("Mantenimiento de Usuario","Usuario",n.Mensaje,"Content/Images/IconoConfimacion1.png",function(){return!1}):Utils.MessageBox("Mantenimiento de Usuario","Usuario",n.Mensaje,"Content/Images/IconoErrorGeneral.png",function(){return!1})})};n.Cancelar=function(){n.model.Descripcion=""};n.SeguridadJS=function(){var n=JSON.parse(sessionStorage.getItem("role")),t;n!=null&&(t=n.where(function(n){return n.TipoAccionId==3&&n.ReferenciasAux=="VerUsuariosController"}),$.each(t,function(n,t){var i=eval("$scope."+t.ReferenciaJS);i!=undefined&&i!=null&&i!=""&&eval("$scope."+t.ReferenciaJS+"= function () { }")}))}})})();