"use strict";(function(){angular.module("BacApp.controllers.RealizarPregrabada",[]).controller("RealizarPregrabadaController",function(n,t,i,r){n.IdPostulante=Utils.getUrlParameter("IdPostulante");n.IdEntrevista=Utils.getUrlParameter("IdEntrevista");n.IdPregunta=Utils.getUrlParameter("IdPregunta");n.Nombre="";n.Puesto="";n.IdArea=0;n.IdPuesto=0;n.Preguntas={};n.secuencia=0;n.TotalPreguntas={};n.segundos=300;n.Pregunta=0;n.ShowReview=!1;n.MostrarEntrevista=!0;n.GetPreguntas=function(){var t=Utils.decodeJWT().UserId,i={IdEntrevista:{value:n.IdEntrevista},IdPostulante:{value:n.IdPostulante},IdUser:{value:t}};u(i,ApiService.GetPreguntasByEntrevista,function(t){if(t.Resultado){var i=t.Objeto;n.Nombre=i.nombre;n.Puesto=i.puesto;n.Preguntas=i.list;sessionStorage.setItem("Preguntas",JSON.stringify(n.Preguntas));sessionStorage.setItem("Secuencia",0)}else n.MostrarEntrevista=!1,Utils.MessageBox("Entrevista Pregrabada","Entrevista Pregrabada",t.Mensaje,"Content/Images/IconoErrorGeneral.png",function(){return window.location=r.baseUrl+"Postulante/Verperfil",!1})})};n.IniciarEntrevista=function(){var t=JSON.parse(sessionStorage.getItem("Preguntas")),i=t[0].Preguntas.IdPregunta;window.location=r.baseUrl+"Entrevistas/AplicarEntrevista?IdPregunta="+i+"&IdEntrevista="+n.IdEntrevista+"&IdPostulante="+n.IdPostulante};n.SiguientePregunta=function(){var t=JSON.parse(sessionStorage.getItem("Preguntas")),u=sessionStorage.getItem("Secuencia"),i=Number(u)+1,f;sessionStorage.setItem("Secuencia",i);t[u]!=undefined?t[i]!=undefined?(f=t[i].Preguntas.IdPregunta,window.location=r.baseUrl+"Entrevistas/AplicarEntrevista?IdPregunta="+f+"&IdEntrevista="+n.IdEntrevista+"&IdPostulante="+n.IdPostulante):window.location=r.baseUrl+"Entrevistas/FinalizarEntrevista?IdEntrevista="+n.IdEntrevista+"&IdPostulante="+n.IdPostulante:window.location=r.baseUrl+"Entrevistas/FinalizarEntrevista?IdEntrevista="+n.IdEntrevista+"&IdPostulante="+n.IdPostulante};n.CargarPregunta=function(){var r={},t=JSON.parse(sessionStorage.getItem("Preguntas")),i=sessionStorage.getItem("Secuencia"),u;n.secuencia=Number(i)+1;n.TotalPreguntas=t.length;n.segundos=t[i].Tiempo;n.Pregunta=t[i].Preguntas.Descripcion;sessionStorage.hasOwnProperty("videos")?(r=JSON.parse(sessionStorage.getItem("videos")),u=r.any(function(t){return t.IdPregunta==n.IdPregunta}),u?(n.ShowReview=!0,$("#divRecord").empty(),$("#btnSiguientePregunta").length!=0&&$("#btnSiguientePregunta").removeClass("hidden")):n.ShowReview=!1):n.ShowReview=!1};n.GuardarEntrevista=function(){var t=JSON.parse(sessionStorage.getItem("videos")),i={IdEntrevista:n.IdEntrevista,PreguntasVideo:t};f(i,ApiService.SaveVideosPregrabada,function(n){n.Resultado?$("#popupLoading").modal("hide"):Utils.MessageBox("Entrevista Pregrabada","Entrevista Pregrabada",n.Mensaje,"Content/Images/IconoErrorGeneral.png",function(){return $("#popupLoading").modal("hide"),this.hide(),!1})})};n.FinalizarEntrevista=function(){$("#popupLoading").modal("show");Utils.MessageBox("Entrevista Pregrabada","Entrevista Pregrabada","Entrevista guardada con Ã©xito","Content/Images/IconoEntrevistaAgendada.png",function(){return $("#popupLoading").modal("hide"),this.hide(),window.location=r.baseUrl+"Postulante/Verperfil",!1})};var u=function(n,t,r){var u=Utils.getFilterParameters(n);i.doGet(t,u).then(r)},f=function(n,t,r){var u={Objeto:n,Lista:[],Token:"",Id:0};i.doPost(t,u).then(r)};n.SeguridadJS=function(){var n=JSON.parse(sessionStorage.getItem("role")),t;n!=null&&(t=n.where(function(n){return n.TipoAccionId==3&&n.ReferenciasAux=="RealizarPregrabadaController"}),$.each(t,function(n,t){var i=eval("$scope."+t.ReferenciaJS);i!=undefined&&i!=null&&i!=""&&eval("$scope."+t.ReferenciaJS+"= function () { }")}))}})})();